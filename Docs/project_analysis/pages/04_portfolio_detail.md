# 화면 기획서: 포트폴리오 상세

> **Screen ID**: `screen-detail`  
> **Phase**: 1 (MVP)  
> **우선순위**: P1  
> **마지막 수정**: 2026-01-04

---

## 📋 화면 개요

| 항목 | 내용 |
|-----|------|
| **화면명** | 포트폴리오 상세 |
| **목적** | 개별 포트폴리오의 종목별 현황 및 비율 확인 |
| **진입 경로** | 홈 → 포트폴리오 카드 탭 |
| **이동 가능 화면** | ← 홈, → 종목 검색, → 리밸런싱 분석, → 편집 모달 |

### 사용자 스토리
>
> "투자자로서 나는 각 종목의 **현재 비율과 목표 비율의 차이**를 직관적으로 파악하고, 리밸런싱이 필요한지 판단하고 싶다."

---

## 🎯 핵심 사용자 니즈

| 니즈 | 중요도 | 현재 충족 여부 |
|-----|--------|--------------|
| 종목별 비율 vs 목표 비교 | ⭐⭐⭐ | ✅ (비율 바) |
| 포트폴리오 총 수익 확인 | ⭐⭐⭐ | ✅ |
| 종목별 수익률 확인 | ⭐⭐ | ✅ |
| 리밸런싱 필요성 빠른 판단 | ⭐⭐⭐ | ⚠️ (개선 가능) |
| 종목 상세 정보 (수량, 단가) | ⭐ | ❌ (미구현) |

---

## 🧩 현재 구현 요소

```
┌─────────────────────────────────────┐
│  ←  메인 포트폴리오           ✏️   │
├─────────────────────────────────────┤
│ ┌─────────┬─────────┐              │
│ │총 평가금  │총 매입금  │              │
│ │₩32.45M  │₩30.25M  │              │
│ ├─────────┼─────────┤              │
│ │ 수익금   │ 수익률   │              │
│ │+₩2.2M   │ +7.27%  │              │
│ └─────────┴─────────┘              │
├─────────────────────────────────────┤
│ 보유 종목                    5종목   │
├─────────────────────────────────────┤
│ 종목명        비율          평가금액  │
│─────────────────────────────────────│
│ 삼성전자      ████░ 35%    ₩11.3M  │
│ 005930       (목표30%)     +5.2%   │
│─────────────────────────────────────│
│ SK하이닉스    ███░ 25%     ₩8.1M   │
│ 000660       (목표25%)     +8.1%   │
│─────────────────────────────────────│
│ NAVER        ██░ 20%      ₩6.4M   │
│ 035420       (목표20%)     +3.7%   │
│─────────────────────────────────────│
│ 카카오        █░ 12%       ₩3.8M   │
│ 035720       (목표15%)     -4.3%   │
│─────────────────────────────────────│
│ LG에너지솔루션  ░ 8%         ₩2.5M   │
│ 373220       (목표10%)     +12.5%  │
├─────────────────────────────────────┤
│ [+ 종목 추가]   [⚖️ 리밸런싱 분석]   │
└─────────────────────────────────────┘
```

---

## 💡 개선 아이디어

### 1. 비율 표현 방식 개선 ⭐⭐⭐ (핵심)

#### 현재: 진행도 바 (Progress Bar)

```
삼성전자  ████████████░░░░  35% (목표 30%)
```

- 전체 대비 위치는 알지만, **초과/미달 정도** 파악 어려움

#### 제안: 초과/미달 바 (Deviation Bar)

```
삼성전자      ━━━|████▌     +5%p 초과  ← 매도필요 (파랑)
              중심↑
                   
카카오        ▌████|━━━     -3%p 미달  ← 매수필요 (빨강)
                  중심↑
```

#### 제안: 하이브리드 방식 ✅ 권장

```
┌───────────────────────────────────────────┐
│ 삼성전자                           ₩11.3M │
│ 005930                            +5.2%  │
│                                          │
│ 현재 35%  ━━━━|██▌        목표 30%        │
│                [+5%p 초과] ← 파란 태그    │
└───────────────────────────────────────────┘
```

**장점**:

- 중심선 기준으로 초과/미달 즉시 파악
- 숫자 태그로 정확한 괴리 확인
- 색상으로 액션 방향 암시 (매수/매도)

### 2. 종목 클릭 시 상세 정보

```
┌───────────────────────────────────────────┐
│ 삼성전자 005930                    [X]   │
├───────────────────────────────────────────┤
│ 현재가         ₩74,500     +1.2% 🔺     │
│ 보유 수량      150주                      │
│ 평균 매입가    ₩71,200                   │
│ 평가금액       ₩11,175,000               │
│ 수익금         +₩495,000 (+4.6%)         │
├───────────────────────────────────────────┤
│ 현재 비율      35%                        │
│ 목표 비율      30%                        │
│ 괴리           +5%p (임계값 ±5% 초과)     │
├───────────────────────────────────────────┤
│ [수정]              [삭제]                │
└───────────────────────────────────────────┘
```

### 3. 종목 정렬 옵션

```
정렬: [비율순 ▼]
      - 비율순 (높은순) ← 기본
      - 금액순 (높은순)
      - 수익률순 (높은순)
      - 이름순
```

### 4. 비율 합계 표시

```
┌─────────────────────────────────────┐
│ 보유 종목                   5종목   │
│ 비율 합계: 100% ✓                  │
└─────────────────────────────────────┘
```

- 100%가 아닐 경우 경고: "비율 합계: 95% ⚠️ (현금 5%)"

### 5. 빠른 리밸런싱 인사이트

```
┌─────────────────────────────────────────┐
│ ⚠️ 리밸런싱 필요                        │
│ 삼성전자 +5%p 초과 | 카카오 -3%p 미달   │
│                    [상세 분석 →]        │
└─────────────────────────────────────────┘
```

- 상세 페이지로 가지 않아도 힌트 제공

---

## ⚠️ 엣지 케이스 및 에러 상태

| 상황 | 현재 처리 | 권장 처리 |
|-----|----------|----------|
| 종목 0개 | ❌ 없음 | Empty State + 종목 추가 CTA |
| 종목 1개 | ❌ 없음 | 리밸런싱 불가 안내 |
| 비율 합계 ≠ 100% | ❌ 없음 | 경고 표시 |
| 시세 조회 실패 | ❌ 없음 | 마지막 캐시 + 오류 표시 |
| 상장폐지 종목 | ❌ 없음 | 경고 배지 + 삭제 유도 |

### Empty State (종목 0개)

```
┌─────────────────────────────────────┐
│                                     │
│              📈                     │
│                                     │
│     아직 종목이 없어요              │
│   첫 종목을 추가해보세요!          │
│                                     │
│       [+ 종목 추가]                 │
│                                     │
└─────────────────────────────────────┘
```

---

## 🔄 화면 상태 (States)

### 1. Loading State

- Summary Grid: 스켈레톤
- 종목 리스트: 스켈레톤 3줄

### 2. Editing Mode (제스처)

```
╔═══════════════════════════════════════╗
║ 삼성전자  ← 스와이프              🗑️ ║
╚═══════════════════════════════════════╝
```

- 좌측 스와이프: 삭제 버튼 노출
- 우측 스와이프: 편집 버튼 노출 (선택)

---

## 📐 테이블 vs 카드 레이아웃

| 종목 수 | 권장 레이아웃 |
|--------|-------------|
| 1~5개 | 테이블 (밀도 높음) |
| 6개 이상 | 카드 리스트 (스크롤 명확) |

### 모바일 최적화

- 테이블 헤더: 고정 (sticky)
- 가로 스크롤: 없음 (정보 압축)
- 비율 바: 너비 고정 (80px)

---

## ✅ 체크리스트

### MVP (Phase 1)

- [x] Summary Grid (4개 지표)
- [x] 종목 리스트 (비율 바)
- [x] 종목 추가 버튼
- [x] 리밸런싱 분석 버튼
- [ ] 비율 표현 개선 (초과/미달 바)
- [ ] 종목 클릭 상세 정보
- [ ] 종목 삭제 기능

### Phase 2

- [ ] 종목 정렬 옵션
- [ ] 드래그로 종목 순서 변경
- [ ] 종목별 메모 기능

---

## 🔗 관련 문서

- [03_home.md](./03_home.md) - 이전 화면 (홈)
- [05_stock_search.md](./05_stock_search.md) - 종목 추가
- [06_rebalancing.md](./06_rebalancing.md) - 리밸런싱 분석
- [ux_design_recommendations.md](../ux_design_recommendations.md) - 비율 표현 상세 가이드
